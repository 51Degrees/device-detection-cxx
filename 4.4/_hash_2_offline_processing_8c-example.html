<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection C/C++: Hash/OfflineProcessing.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.4/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Device Detection C/C++
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">A device detection library that is used natively or by 51Degrees products</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_hash_2_offline_processing_8c-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="g-docs__header">
<h2 class="g-docs__page-title">Hash/OfflineProcessing.c</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>Provides an example of processing a YAML file containing evidence for device detection.There are 20,000 examples in the supplied file of evidence representing HTTP Headers. For example:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">header.user-agent: <span class="c-code__stringliteral">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#39;</span></div><div class="c-code__line">header.sec-ch-ua: <span class="c-code__stringliteral">&#39;&quot; Not A;Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;98&quot;, &quot;Google Chrome&quot;;v=&quot;98&quot;&#39;</span></div><div class="c-code__line">header.sec-ch-ua-full-version: <span class="c-code__stringliteral">&#39;&quot;98.0.4758.87&quot;&#39;</span></div><div class="c-code__line">header.sec-ch-ua-mobile: <span class="c-code__stringliteral">&#39;?0&#39;</span></div><div class="c-code__line">header.sec-ch-ua-platform: <span class="c-code__stringliteral">&#39;&quot;Android&quot;&#39;</span></div></div><p>We create a resource manager and results hash to read the data and find out about the associated device, we write this data to a YAML formatted output stream.</p>
<p>As well as explaining the basic operation of offline processing using the defaults, for advanced operation this example can be used to experiment with tuning device detection for performance and predictive power using Performance Profile, Graph and Difference and Drift settings.</p>
<p>This example is available in full on <a href="https://github.com/51Degrees/device-detection-cxx/blob/master/examples/C/Hash/OfflineProcessing.c">GitHub</a></p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__comment">/* *********************************************************************</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><span class="c-code__comment"> * Copyright 2023 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><span class="c-code__comment"> * Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><span class="c-code__comment"> * (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><span class="c-code__comment"> * one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><span class="c-code__comment"> * amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><span class="c-code__comment"> * the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><span class="c-code__comment"> * clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><span class="c-code__comment"> * including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><span class="c-code__comment"> * in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><span class="c-code__comment"> * such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><span class="c-code__comment"> * ********************************************************************* */</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Include ExmapleBase.h before others as it includes Windows &#39;crtdbg.h&#39;</span></div><div class="c-code__line"><span class="c-code__comment">// which requires to be included before &#39;malloc.h&#39;.</span></div><div class="c-code__line"><span class="c-code__preprocessor">#include &quot;ExampleBase.h&quot;</span></div><div class="c-code__line"><span class="c-code__preprocessor">#include &quot;../../../src/hash/hash.h&quot;</span></div><div class="c-code__line"><span class="c-code__preprocessor">#include &quot;../../../src/common-cxx/textfile.h&quot;</span></div><div class="c-code__line"><span class="c-code__preprocessor">#include &quot;../../../src/hash/fiftyone.h&quot;</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *dataDir = <span class="c-code__stringliteral">&quot;device-detection-data&quot;</span>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// In this example, by default, the 51degrees &quot;Lite&quot; file needs to be somewhere in the</span></div><div class="c-code__line"><span class="c-code__comment">// project space, or you may specify another file as a command line parameter.</span></div><div class="c-code__line"><span class="c-code__comment">//</span></div><div class="c-code__line"><span class="c-code__comment">// Note that the Lite data file is only used for illustration, and has limited accuracy</span></div><div class="c-code__line"><span class="c-code__comment">// and capabilities. Find out about the Enterprise data file on our pricing page:</span></div><div class="c-code__line"><span class="c-code__comment">// https://51degrees.com/pricing</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *dataFileName = <span class="c-code__stringliteral">&quot;51Degrees-LiteV4.1.hash&quot;</span>;</div><div class="c-code__line"><span class="c-code__comment">// This file contains the 20,000 most commonly seen combinations of header values </span></div><div class="c-code__line"><span class="c-code__comment">// that are relevant to device detection. For example, User-Agent and UA-CH headers.</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *evidenceFileName = <span class="c-code__stringliteral">&quot;20000 Evidence Records.yml&quot;</span>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">char</span> valueBuffer[1024] = <span class="c-code__stringliteral">&quot;&quot;</span>;</div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">size_t</span> valueBufferLength = <span class="c-code__keyword">sizeof</span>(valueBuffer) / <span class="c-code__keyword">sizeof</span>(valueBuffer[0]);</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// We use the low memory profile as its performance is sufficient for this</span></div><div class="c-code__line"><span class="c-code__comment">// example. See the documentation for more detail on this and other</span></div><div class="c-code__line"><span class="c-code__comment">// configuration options:</span></div><div class="c-code__line"><span class="c-code__comment">// http://51degrees.com/documentation/_device_detection__features__performance_options.html</span></div><div class="c-code__line"><span class="c-code__comment">// http://51degrees.com/documentation/_features__automatic_datafile_updates.html</span></div><div class="c-code__line"><span class="c-code__comment">// http://51degrees.com/documentation/_features__usage_sharing.html</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// #define CONFIG fiftyoneDegreesHashInMemoryConfig</span></div><div class="c-code__line"><span class="c-code__comment">// #define CONFIG fiftyoneDegreesHashHighPerformanceConfig</span></div><div class="c-code__line"><span class="c-code__preprocessor">#define CONFIG fiftyoneDegreesHashLowMemoryConfig</span></div><div class="c-code__line"><span class="c-code__comment">// #define CONFIG fiftyoneDegreesHashBalancedConfig</span></div><div class="c-code__line"><span class="c-code__comment">// #define CONFIG fiftyoneDegreesHashBalancedTempConfig</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">typedef</span> <span class="c-code__keyword">struct </span>t_offline_processing_state {</div><div class="c-code__line">    FILE *outputFile; </div><div class="c-code__line">    FILE *outputLog; </div><div class="c-code__line">    <a name="_a0"></a><a class="code" href="structfiftyone_degrees_result_hash_array.html">ResultsHash</a> *results; </div><div class="c-code__line">} <a name="_a1"></a><a class="code" href="structoffline_process_state.html">offlineProcessState</a>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> outputDeviceId(</div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_result_hash_array.html">ResultsHash</a> *results,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *name,</div><div class="c-code__line">    FILE *output) {</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> buffer[50];</div><div class="c-code__line">    <a name="a2"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a></div><div class="c-code__line">    <a name="a3"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaef378eaba9b3f20b68efc4f30dc3cab7">HashGetDeviceIdFromResults</a> (results, buffer, 50, exception);</div><div class="c-code__line">    <a name="a4"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a></div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;%s: %s\n&quot;</span>, name, buffer);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> outputValue(</div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_result_hash_array.html">ResultsHash</a> *results,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *name,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* propertyName,</div><div class="c-code__line">    FILE *output) {</div><div class="c-code__line">    <a name="_a5"></a><a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>* dataset = (<a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>*)results-&gt;<a name="a6"></a><a class="code" href="structfiftyone_degrees_result_hash_array.html#a0b613284cd3b79bbcb76cd694b77ac91">b</a>.<a name="a7"></a><a class="code" href="structfiftyone_degrees_results_device_detection.html#ab274eced26b8fd68a8170b27dac75dde">b</a>.<a name="a8"></a><a class="code" href="structfiftyone_degrees_results_base.html#acb1eb8a8fb245ea49299b19fd71fa1d5">dataSet</a>;</div><div class="c-code__line">    <span class="c-code__keywordtype">int</span> requiredIndex = <a name="a9"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga4b242308dfc68d6092df3607fbccd0cc">PropertiesGetRequiredPropertyIndexFromName</a>(</div><div class="c-code__line">        dataset-&gt;<a name="a10"></a><a class="code" href="structfiftyone_degrees_data_set_hash.html#a55d7db87af4c400bca7d04581a95b533">b</a>.<a name="a11"></a><a class="code" href="structfiftyone_degrees_data_set_device_detection.html#a69c6c6bb7cf4fea8d484e3dbe01053fb">b</a>.<a name="a12"></a><a class="code" href="structfiftyone_degrees_data_set_base.html#afb6fe7080fd386b7b4233ce5c87ce3c2">available</a>,</div><div class="c-code__line">        propertyName);</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a>;</div><div class="c-code__line">    <span class="c-code__comment">// If a value has not been set then trying to access the value will</span></div><div class="c-code__line">    <span class="c-code__comment">// result in an exception.</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (<a name="a13"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gad3bee8167d56b6f7dbcff060c2564454">ResultsHashGetHasValues</a>(</div><div class="c-code__line">        results, requiredIndex, exception)) {</div><div class="c-code__line">        <a name="a14"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga1a4566495159559ee999f0b3780f63c9">ResultsHashGetValuesString</a>(</div><div class="c-code__line">            results,</div><div class="c-code__line">            propertyName,</div><div class="c-code__line">            valueBuffer,</div><div class="c-code__line">            valueBufferLength,</div><div class="c-code__line">            <span class="c-code__stringliteral">&quot;,&quot;</span>,</div><div class="c-code__line">            exception);</div><div class="c-code__line">        <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a>;</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">        <span class="c-code__comment">// A no value message can also be obtained. This message describes why</span></div><div class="c-code__line">        <span class="c-code__comment">// the value has not been set.</span></div><div class="c-code__line">        <a class="code" href="group___fifty_one_degrees_results.html#gaef347b638495391733e5962b576321e6">fiftyoneDegreesResultsNoValueReason</a> reason =</div><div class="c-code__line">            <a name="a15"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga840206fdcd9bc13e7542cc9037fba112">ResultsHashGetNoValueReason</a>(results, requiredIndex, exception);</div><div class="c-code__line">        <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a>;</div><div class="c-code__line"></div><div class="c-code__line">        snprintf(valueBuffer, valueBufferLength, <span class="c-code__stringliteral">&quot;Unknown (%s)&quot;</span>, <a name="a16"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gae634e1ec6a534a98af8603fec434282f">ResultsHashGetNoValueReasonMessage</a>(reason));</div><div class="c-code__line">    }</div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;%s: %s\n&quot;</span>, name, valueBuffer);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> analyse(</div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_result_hash_array.html">ResultsHash</a>* results,</div><div class="c-code__line">    <a name="_a17"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair_array.html">EvidenceKeyValuePairArray</a>* <a name="_a18"></a><a class="code" href="structevidence.html">evidence</a>,</div><div class="c-code__line">    FILE* outputFile) {</div><div class="c-code__line">    <span class="c-code__comment">// Information required for detection is called &quot;evidence&quot;</span></div><div class="c-code__line">    <span class="c-code__comment">// and usually consists of a number of HTTP Header field</span></div><div class="c-code__line">    <span class="c-code__comment">// values, in this case represented by a</span></div><div class="c-code__line">    <span class="c-code__comment">// Object of header name/value entries.</span></div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// list the evidence</span></div><div class="c-code__line">    fprintf(outputFile, <span class="c-code__stringliteral">&quot;---\n&quot;</span>);</div><div class="c-code__line">    <span class="c-code__keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="structevidence.html">evidence</a>-&gt;<a name="a19"></a>count; i++) {</div><div class="c-code__line">        <a name="_a20"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html">EvidenceKeyValuePair</a> e = <a class="code" href="structevidence.html">evidence</a>-&gt;<a name="a21"></a>items[i];</div><div class="c-code__line">        fprintf(outputFile,</div><div class="c-code__line">            <span class="c-code__stringliteral">&quot;%s%s: %s\n&quot;</span>,</div><div class="c-code__line">            <a name="a22"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gafba221e58a3a1de00a75ae1f8e1b5131">EvidencePrefixString</a>(e.<a name="a23"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a6ec74551ed0d5a2790ab5bdb9077d1cb">prefix</a>), e.<a name="a24"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a493749e42a43b301a038dfcb79c06c3d">field</a>, (<span class="c-code__keywordtype">char</span> *)e.<a name="a25"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a88d60bc3fd37384ce75371b76bb4ba3a">originalValue</a>);</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a></div><div class="c-code__line">    <a name="a26"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga3695959f3706c2b267ad02133aab0f7b">ResultsHashFromEvidence</a>(results, <a class="code" href="structevidence.html">evidence</a>, exception);</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a></div><div class="c-code__line"></div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;device.ismobile&quot;</span>, <span class="c-code__stringliteral">&quot;IsMobile&quot;</span>, outputFile);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;device.platformname&quot;</span>, <span class="c-code__stringliteral">&quot;PlatformName&quot;</span>, outputFile);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;device.platformversion&quot;</span>, <span class="c-code__stringliteral">&quot;PlatformVersion&quot;</span>, outputFile);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;device.browsername&quot;</span>, <span class="c-code__stringliteral">&quot;BrowserName&quot;</span>, outputFile);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;device.browserversion&quot;</span>, <span class="c-code__stringliteral">&quot;BrowserVersion&quot;</span>, outputFile);</div><div class="c-code__line">    <span class="c-code__comment">// DeviceId is a unique identifier for the combination of hardware, operating</span></div><div class="c-code__line">    <span class="c-code__comment">// system, browser and crawler that has been detected.</span></div><div class="c-code__line">    <span class="c-code__comment">// Our device detection solution uses machine learning to find the optimal</span></div><div class="c-code__line">    <span class="c-code__comment">// way to identify devices based on the real-world evidence values that we</span></div><div class="c-code__line">    <span class="c-code__comment">// observe each day.</span></div><div class="c-code__line">    <span class="c-code__comment">// As this changes over time, the result of detection can potentially change</span></div><div class="c-code__line">    <span class="c-code__comment">// as well. By storing the device id, we can use this as a lookup in future</span></div><div class="c-code__line">    <span class="c-code__comment">// rather than performing detection with the original evidence again.</span></div><div class="c-code__line">    <span class="c-code__comment">// Do this by passing an evidence entry with:</span></div><div class="c-code__line">    <span class="c-code__comment">// key = query.51D_ProfileIds</span></div><div class="c-code__line">    <span class="c-code__comment">// value = [the device id]</span></div><div class="c-code__line">    <span class="c-code__comment">// This is much faster and avoids the potential for getting a different </span></div><div class="c-code__line">    <span class="c-code__comment">// result.</span></div><div class="c-code__line">    outputDeviceId(results, <span class="c-code__stringliteral">&quot;device.deviceid&quot;</span>, outputFile);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> process(<a name="_a27"></a><a class="code" href="structfiftyone_degrees_key_value_pair.html">KeyValuePair</a> *pairs, uint16_t size, <span class="c-code__keywordtype">void</span> *state) {</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a>;</div><div class="c-code__line">    <a class="code" href="structoffline_process_state.html">offlineProcessState</a> *offline = (<a class="code" href="structoffline_process_state.html">offlineProcessState</a>*)state;</div><div class="c-code__line">    <span class="c-code__comment">// Create an evidence collection and add the evidence to the collection</span></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_evidence_key_value_pair_array.html">EvidenceKeyValuePairArray</a>* evidenceArray = <a name="a28"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga324c123e74727b62612edeead5d0f6a6">EvidenceCreate</a>(size);</div><div class="c-code__line">    <span class="c-code__keywordflow">for</span> (uint32_t i = 0; i &lt; size; i++) {</div><div class="c-code__line">        <span class="c-code__comment">// Get prefix</span></div><div class="c-code__line">        <a name="_a29"></a><a class="code" href="structfiftyone_degrees_evidence_prefix_map.html">EvidencePrefixMap</a> *prefixMap = <a name="a30"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gaf31a20347d083f97ecfffc854487c2fc">EvidenceMapPrefix</a>(pairs[i].key);</div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> (prefixMap) {</div><div class="c-code__line">            <span class="c-code__comment">// Add the evidence as string</span></div><div class="c-code__line">            <a name="a31"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga9154c7bee1590af184d75fbe74a1c4dd">EvidenceAddString</a>(</div><div class="c-code__line">                evidenceArray,</div><div class="c-code__line">                prefixMap-&gt;<a name="a32"></a><a class="code" href="structfiftyone_degrees_evidence_prefix_map.html#a8cb7654e0cd2014834d7da1a9217a10d">prefixEnum</a>,</div><div class="c-code__line">                pairs[i].key + prefixMap-&gt;<a name="a33"></a><a class="code" href="structfiftyone_degrees_evidence_prefix_map.html#ab97e3de2bca265436f4552ecae6d6c28">prefixLength</a>,</div><div class="c-code__line">                pairs[i].value);</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line">    analyse(</div><div class="c-code__line">        offline-&gt;<a name="a34"></a><a class="code" href="structoffline_process_state.html#a409122745b78a768bbd438eb9d08c148">results</a>,</div><div class="c-code__line">        evidenceArray,</div><div class="c-code__line">        offline-&gt;<a name="a35"></a><a class="code" href="structoffline_process_state.html#a13e7c4dff1a43751c5db23ea0de92e7c">outputFile</a>);</div><div class="c-code__line">    <span class="c-code__comment">// Ensure the evidence collection is freed after used</span></div><div class="c-code__line">    <a name="a36"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gac0d0435d95ea76ed3ee71c0348b3be81">EvidenceFree</a>(evidenceArray);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keywordtype">void</span> run(</div><div class="c-code__line">    <a name="_a37"></a><a class="code" href="structfiftyone_degrees_resource_manager.html">ResourceManager</a> *manager, </div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *evidenceFilePath, </div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *outputFilePath,</div><div class="c-code__line">    FILE *output) {</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> buffer[1000];</div><div class="c-code__line">    <a class="code" href="structoffline_process_state.html">offlineProcessState</a> state;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Open a fresh data file for writing the output to.</span></div><div class="c-code__line">    <a name="a38"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gacf90f6c3d896757c8fabdf548da658e1">FileDelete</a>(outputFilePath);</div><div class="c-code__line">    state.<a class="code" href="structoffline_process_state.html#a13e7c4dff1a43751c5db23ea0de92e7c">outputFile</a> = fopen(outputFilePath, <span class="c-code__stringliteral">&quot;w&quot;</span>);</div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (state.<a class="code" href="structoffline_process_state.html#a13e7c4dff1a43751c5db23ea0de92e7c">outputFile</a> == NULL) {</div><div class="c-code__line">        fprintf(output, <span class="c-code__stringliteral">&quot;Could not open file %s for write\n&quot;</span>, outputFilePath);</div><div class="c-code__line">        <span class="c-code__keywordflow">return</span>;</div><div class="c-code__line">    }</div><div class="c-code__line">    state.<a name="a39"></a><a class="code" href="structoffline_process_state.html#a8f75f41a49eca314671defae0e51abd9">outputLog</a> = output;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Get the results and data set from the manager. Use a higher closest </span></div><div class="c-code__line">    <span class="c-code__comment">// number of signatures than the default because performance is less </span></div><div class="c-code__line">    <span class="c-code__comment">// important for offline processing and expanding the number of </span></div><div class="c-code__line">    <span class="c-code__comment">// alternatives evaluated can lead to a better result.</span></div><div class="c-code__line">    state.<a class="code" href="structoffline_process_state.html#a409122745b78a768bbd438eb9d08c148">results</a> = <a name="a40"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga6eee92bf88015e1e2caba34a2f4589d6">ResultsHashCreate</a>(manager, 10, 10);</div><div class="c-code__line"></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_key_value_pair.html">KeyValuePair</a> pair[10];</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> key[10][500];</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> value[10][1000];</div><div class="c-code__line">    <span class="c-code__keywordflow">for</span> (<span class="c-code__keywordtype">int</span> i = 0; i &lt; 10; i++) {</div><div class="c-code__line">        pair[i].<a name="a41"></a>key = key[i];</div><div class="c-code__line">        pair[i].<a name="a42"></a>keyLength = 500;</div><div class="c-code__line">        pair[i].<a name="a43"></a>value = value[i];</div><div class="c-code__line">        pair[i].<a name="a44"></a>valueLength = 1000;</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Perform offline processing.</span></div><div class="c-code__line">    <a name="a45"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga5233b40686dfa0a61c5dc52bb66bdef0">YamlFileIterate</a>(</div><div class="c-code__line">        evidenceFilePath,</div><div class="c-code__line">        buffer,</div><div class="c-code__line">        <span class="c-code__keyword">sizeof</span>(buffer),</div><div class="c-code__line">        pair,</div><div class="c-code__line">        10,</div><div class="c-code__line">        &amp;state,</div><div class="c-code__line">        process</div><div class="c-code__line">    );</div><div class="c-code__line">    fprintf(state.<a class="code" href="structoffline_process_state.html#a13e7c4dff1a43751c5db23ea0de92e7c">outputFile</a>, <span class="c-code__stringliteral">&quot;...\n&quot;</span>);</div><div class="c-code__line"></div><div class="c-code__line">    fclose(state.<a class="code" href="structoffline_process_state.html#a13e7c4dff1a43751c5db23ea0de92e7c">outputFile</a>);</div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;Output Written to %s\n&quot;</span>, outputFilePath);</div><div class="c-code__line"></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>* dataset = (<a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a> *)state.<a class="code" href="structoffline_process_state.html#a409122745b78a768bbd438eb9d08c148">results</a>-&gt;<a class="code" href="structfiftyone_degrees_result_hash_array.html#a0b613284cd3b79bbcb76cd694b77ac91">b</a>.<a class="code" href="structfiftyone_degrees_results_device_detection.html#ab274eced26b8fd68a8170b27dac75dde">b</a>.<a class="code" href="structfiftyone_degrees_results_base.html#acb1eb8a8fb245ea49299b19fd71fa1d5">dataSet</a>;</div><div class="c-code__line">    fiftyoneDegreesExampleCheckDataFile(dataset);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Free the memory used by the results instance.</span></div><div class="c-code__line">    <a name="a46"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaef12979129e46a5fd7ebb6be8867a88d">ResultsHashFree</a>(state.<a class="code" href="structoffline_process_state.html#a409122745b78a768bbd438eb9d08c148">results</a>);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> reportStatus(</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_status.html#ga887881c8b6ec9f0c8510913831ebd19e">StatusCode</a> status,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* fileName) {</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *message = <a name="a47"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga3002890a18e3a86e4078880f2b00bbad">StatusGetMessage</a>(status, fileName);</div><div class="c-code__line">    <a name="a48"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gae0ecd1fc988dbb64ff0232a001e090bf">Free</a>((<span class="c-code__keywordtype">void</span>*)message);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keywordtype">void</span> fiftyoneDegreesOfflineProcessingRun(</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *dataFilePath,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *evidenceFilePath,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *outputFilePath, </div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *requiredProperties,</div><div class="c-code__line">    <a name="_a49"></a><a class="code" href="structfiftyone_degrees_config_hash.html">ConfigHash</a> config,</div><div class="c-code__line">    FILE* output) {</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a>;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Set concurrency to ensure sufficient shared resources available.</span></div><div class="c-code__line">    config.<a name="a50"></a><a class="code" href="structfiftyone_degrees_config_hash.html#a5476be1948230837b742d4feb2c58281">nodes</a>.<a name="a51"></a><a class="code" href="structfiftyone_degrees_collection_config.html#af3dee101ea5b465a0a40f1899487e041">concurrency</a> =</div><div class="c-code__line">        config.<a name="a52"></a><a class="code" href="structfiftyone_degrees_config_hash.html#acd156b439ec81a3f3f417e9042bcf60a">profiles</a>.<a class="code" href="structfiftyone_degrees_collection_config.html#af3dee101ea5b465a0a40f1899487e041">concurrency</a> =</div><div class="c-code__line">        config.<a name="a53"></a><a class="code" href="structfiftyone_degrees_config_hash.html#aec1613c07e619680c4141c959b2d0c4f">profileOffsets</a>.<a class="code" href="structfiftyone_degrees_collection_config.html#af3dee101ea5b465a0a40f1899487e041">concurrency</a> =</div><div class="c-code__line">        config.<a name="a54"></a><a class="code" href="structfiftyone_degrees_config_hash.html#a31b3d33236daf27ed0be06bf2186ab2c">rootNodes</a>.<a class="code" href="structfiftyone_degrees_collection_config.html#af3dee101ea5b465a0a40f1899487e041">concurrency</a> =</div><div class="c-code__line">        config.<a name="a55"></a><a class="code" href="structfiftyone_degrees_config_hash.html#a63f3eaf0a39943fd2ebd4f1ee814d5f7">values</a>.<a class="code" href="structfiftyone_degrees_collection_config.html#af3dee101ea5b465a0a40f1899487e041">concurrency</a> =</div><div class="c-code__line">        config.<a name="a56"></a><a class="code" href="structfiftyone_degrees_config_hash.html#a88936a51b61e8d8caea7050e70dd1a57">strings</a>.<a class="code" href="structfiftyone_degrees_collection_config.html#af3dee101ea5b465a0a40f1899487e041">concurrency</a> = 1;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// If time can be sacrificed for a more thorough analysis of the different</span></div><div class="c-code__line">    <span class="c-code__comment">// options then increase the closestSignatures value. More permutations </span></div><div class="c-code__line">    <span class="c-code__comment">// will be considered the higher the number.</span></div><div class="c-code__line">    <span class="c-code__comment">// config.closestSignatures = 50000;</span></div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Set the required properties for the output file.</span></div><div class="c-code__line">    <a name="_a57"></a><a class="code" href="structfiftyone_degrees_properties_required.html">PropertiesRequired</a> properties = <a name="a58"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga246be0840df800ead0edc55949e2e92e">PropertiesDefault</a>;</div><div class="c-code__line">    properties.<a name="a59"></a><a class="code" href="structfiftyone_degrees_properties_required.html#a7044785e8c67e2d208ba1010ec355d5c">string</a> = requiredProperties;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Set the User-Agent update so that we can output the sub strings found </span></div><div class="c-code__line">    <span class="c-code__comment">// and not the entire User-Agent.</span></div><div class="c-code__line">    config.<a name="a60"></a><a class="code" href="structfiftyone_degrees_config_hash.html#a7df616c1c12c853ce8042fa41a184f3f">b</a>.<a name="a61"></a><a class="code" href="structfiftyone_degrees_config_device_detection.html#acee39f8a3a01a5763741e765f9eca8c3">updateMatchedUserAgent</a> = <span class="c-code__keyword">true</span>;</div><div class="c-code__line"></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_resource_manager.html">ResourceManager</a> manager;</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_status.html#ga887881c8b6ec9f0c8510913831ebd19e">StatusCode</a> status = <a name="a62"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaf32e91a9120e015fb219a3044498f7bc">HashInitManagerFromFile</a>(</div><div class="c-code__line">        &amp;manager,</div><div class="c-code__line">        &amp;config,</div><div class="c-code__line">        &amp;properties,</div><div class="c-code__line">        dataFilePath,</div><div class="c-code__line">        exception);</div><div class="c-code__line"></div><div class="c-code__line">    printf(<span class="c-code__stringliteral">&quot;%s\n&quot;</span>, dataFilePath);</div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (status != <a name="a63"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {</div><div class="c-code__line">        reportStatus(status, dataFilePath);</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__comment">// Process the evidence writing the results to the output path.</span></div><div class="c-code__line">        run(&amp;manager, evidenceFilePath, outputFilePath, output);</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__comment">// Free the memory used by the data set.</span></div><div class="c-code__line">        <a name="a64"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gac5094875841e9d95dc972014124ea765">ResourceManagerFree</a>(&amp;manager);</div><div class="c-code__line"></div><div class="c-code__line">        fprintf(output, <span class="c-code__stringliteral">&quot;Processing complete. See results in: &#39;%s&#39;&quot;</span>, outputFilePath);</div><div class="c-code__line">    }</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keywordtype">void</span> fiftyoneDegreesExampleCOfflineProcessingRun(ExampleParameters *params) {</div><div class="c-code__line">    <span class="c-code__comment">// Call the actual function.</span></div><div class="c-code__line">    fiftyoneDegreesOfflineProcessingRun(</div><div class="c-code__line">        params-&gt;dataFilePath,</div><div class="c-code__line">        params-&gt;evidenceFilePath,</div><div class="c-code__line">        params-&gt;outputFilePath,</div><div class="c-code__line">        params-&gt;propertiesString,</div><div class="c-code__line">        *params-&gt;config,</div><div class="c-code__line">        params-&gt;output);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">#ifndef TEST</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* getBaseName(<span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* path) {</div><div class="c-code__line">    <span class="c-code__keywordflow">for</span> (<span class="c-code__keywordtype">size_t</span> i = strlen(path) - 1; i &gt;= 0; i--) {</div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> (path[i] == <span class="c-code__charliteral">&#39;\\&#39;</span> || path[i] == <span class="c-code__charliteral">&#39;/&#39;</span>) {</div><div class="c-code__line">            <span class="c-code__comment">// Check if there is a basename</span></div><div class="c-code__line">            <span class="c-code__keywordflow">if</span> (i == (strlen(path) - 1)) {</div><div class="c-code__line">                <span class="c-code__keywordflow">return</span> NULL;</div><div class="c-code__line">            }</div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> path + i + 1;</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">return</span> path;</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keywordtype">int</span> main(<span class="c-code__keywordtype">int</span> argc, <span class="c-code__keywordtype">char</span>* argv[]) {</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_status.html#ga887881c8b6ec9f0c8510913831ebd19e">StatusCode</a> status = <a class="code" href="group___fifty_one_degrees_synonyms.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> dataFilePath[<a name="a65"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gafd3ee670ff4ed3f29a395abd2f0f3344">FILE_MAX_PATH</a>];</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> evidenceFilePath[<a class="code" href="group___fifty_one_degrees_synonyms.html#gafd3ee670ff4ed3f29a395abd2f0f3344">FILE_MAX_PATH</a>];</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> outputFilePath[<a class="code" href="group___fifty_one_degrees_synonyms.html#gafd3ee670ff4ed3f29a395abd2f0f3344">FILE_MAX_PATH</a>];</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Set data file path</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (argc &gt; 1) {</div><div class="c-code__line">        strcpy(dataFilePath, argv[1]);</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">        status = <a name="a66"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga5ba06bcfd18437e9145833037dd7ecc9">FileGetPath</a>(</div><div class="c-code__line">            dataDir,</div><div class="c-code__line">            dataFileName,</div><div class="c-code__line">            dataFilePath,</div><div class="c-code__line">            <span class="c-code__keyword">sizeof</span>(dataFilePath));</div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> (status != <a class="code" href="group___fifty_one_degrees_synonyms.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {</div><div class="c-code__line">            printf((<span class="c-code__stringliteral">&quot;Failed to find a device detection &quot;</span></div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;data file. Make sure the device-detection-data &quot;</span></div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;submodule has been updated by running &quot;</span></div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;`git submodule update --recursive`&quot;</span>));</div><div class="c-code__line">            fgetc(stdin);</div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> 1;</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Set evidence file path</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (argc &gt; 2) {</div><div class="c-code__line">        strcpy(evidenceFilePath, argv[2]);</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">        status = <a class="code" href="group___fifty_one_degrees_synonyms.html#ga5ba06bcfd18437e9145833037dd7ecc9">FileGetPath</a>(</div><div class="c-code__line">            dataDir,</div><div class="c-code__line">            evidenceFileName,</div><div class="c-code__line">            evidenceFilePath,</div><div class="c-code__line">            <span class="c-code__keyword">sizeof</span>(evidenceFilePath));</div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> (status != <a class="code" href="group___fifty_one_degrees_synonyms.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {</div><div class="c-code__line">            reportStatus(status, evidenceFilePath);</div><div class="c-code__line">            fgetc(stdin);</div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> 1;</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line">    </div><div class="c-code__line">    <span class="c-code__comment">// Set output file path</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (argc &gt; 3) {</div><div class="c-code__line">        strcpy(outputFilePath, argv[3]);</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">        <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* baseName = getBaseName(evidenceFilePath);</div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> (baseName == NULL) {</div><div class="c-code__line">            printf(<span class="c-code__stringliteral">&quot;Invalid evidence file path.\n&quot;</span>);</div><div class="c-code__line">            fgetc(stdin);</div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> 1;</div><div class="c-code__line">        }</div><div class="c-code__line">        <span class="c-code__keywordtype">size_t</span> cpySize = baseName - evidenceFilePath;</div><div class="c-code__line">        strncpy(outputFilePath, evidenceFilePath, cpySize);</div><div class="c-code__line">        strcpy(outputFilePath + cpySize, <span class="c-code__stringliteral">&quot;offline-processing-output.yml&quot;</span>);</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_config_hash.html">ConfigHash</a> config = CONFIG;</div><div class="c-code__line">    ExampleParameters params;</div><div class="c-code__line">    params.dataFilePath = dataFilePath;</div><div class="c-code__line">    params.evidenceFilePath = evidenceFilePath;</div><div class="c-code__line">    params.outputFilePath = outputFilePath;</div><div class="c-code__line">    params.propertiesString = argc &gt; 4 ? argv[4] : <span class="c-code__stringliteral">&quot;&quot;</span>;</div><div class="c-code__line">    params.config = &amp;config;</div><div class="c-code__line">    params.output = stdout;</div><div class="c-code__line">    <span class="c-code__comment">// Run the example</span></div><div class="c-code__line">    fiftyoneDegreesExampleMemCheck(</div><div class="c-code__line">        &amp;params,</div><div class="c-code__line">        fiftyoneDegreesExampleCOfflineProcessingRun);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Wait for a character to be pressed.</span></div><div class="c-code__line">    fgetc(stdin);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keywordflow">return</span> 0;</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">#endif</span></div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
