<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection C/C++: Hash/GettingStarted.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.5/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Device Detection C/C++
   &#160;<span id="projectnumber">4.5</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">A device detection library that is used natively or by 51Degrees products</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_hash_2_getting_started_8c-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="g-docs__header">
<h2 class="g-docs__page-title">Hash/GettingStarted.c</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>This example shows how to use 51Degrees on-premise device detection to determine details about a device based on its User-Agent and User-Agent Client Hint HTTP header values.You will learn:</p><ol type="1">
<li>How to initialise a resource manager and a place holder for the results</li>
<li>How to pass input data (evidence) to the detection APIs</li>
<li>How to retrieve the results</li>
</ol>
<p>This example is available in full on <a href="https://github.com/51Degrees/device-detection-cxx/blob/master/examples/C/Hash/GettingStarted.c">GitHub</a>.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__comment">/* *********************************************************************</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><span class="c-code__comment"> * Copyright 2023 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><span class="c-code__comment"> * Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><span class="c-code__comment"> * (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><span class="c-code__comment"> * one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><span class="c-code__comment"> * amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><span class="c-code__comment"> * the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><span class="c-code__comment"> * clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><span class="c-code__comment"> * including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><span class="c-code__comment"> * in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><span class="c-code__comment"> * such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><span class="c-code__comment"> * ********************************************************************* */</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">#include &lt;stdio.h&gt;</span></div><div class="c-code__line"><span class="c-code__preprocessor">#include &lt;time.h&gt;</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Include ExmapleBase.h before others as it includes Windows &#39;crtdbg.h&#39;</span></div><div class="c-code__line"><span class="c-code__comment">// which requires to be included before &#39;malloc.h&#39;.</span></div><div class="c-code__line"><span class="c-code__preprocessor">#include &quot;ExampleBase.h&quot;</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">#define MAX_EVIDENCE 8</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *dataDir = <span class="c-code__stringliteral">&quot;device-detection-data&quot;</span>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// In this example, by default, the 51degrees &quot;Lite&quot; file needs to be in the</span></div><div class="c-code__line"><span class="c-code__comment">// device-detection-data,</span></div><div class="c-code__line"><span class="c-code__comment">// or you may specify another file as a command line parameter.</span></div><div class="c-code__line"><span class="c-code__comment">//</span></div><div class="c-code__line"><span class="c-code__comment">// Note that the Lite data file is only used for illustration, and has</span></div><div class="c-code__line"><span class="c-code__comment">// limited accuracy and capabilities.</span></div><div class="c-code__line"><span class="c-code__comment">// Find out about the Enterprise data file on our pricing page:</span></div><div class="c-code__line"><span class="c-code__comment">// https://51degrees.com/pricing</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *dataFileName = <span class="c-code__stringliteral">&quot;51Degrees-LiteV4.1.hash&quot;</span>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">char</span> valueBuffer[1024] = <span class="c-code__stringliteral">&quot;&quot;</span>;</div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">size_t</span> valueBufferLength = </div><div class="c-code__line">    <span class="c-code__keyword">sizeof</span>(valueBuffer) / <span class="c-code__keyword">sizeof</span>(valueBuffer[0]);</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">typedef</span> <span class="c-code__keyword">struct </span>{</div><div class="c-code__line">    uint32_t count;</div><div class="c-code__line">    <span class="c-code__keyword">struct </span>{</div><div class="c-code__line">        <a class="code" href="group___fifty_one_degrees_common.html#ga1ff9010650f2716970e86c12c5a97a76">EvidencePrefix</a> prefix;</div><div class="c-code__line">        <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* key;</div><div class="c-code__line">        <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* value;</div><div class="c-code__line">    } items[MAX_EVIDENCE];</div><div class="c-code__line">} <a name="_a0"></a><a class="code" href="structevidence.html">evidence</a>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// A User-Agent from a mobile device.</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <a class="code" href="structevidence.html">evidence</a> mobileDevice = { </div><div class="c-code__line">    1, </div><div class="c-code__line">    { { <a name="a1"></a><a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;user-agent&quot;</span>, (</div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Mozilla/5.0 (Linux; Android 9; SAMSUNG SM-G960U) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;AppleWebKit/537.36 (KHTML, like Gecko) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;SamsungBrowser/10.1 Chrome/71.0.3578.99 Mobile &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Safari/537.36&quot;</span>) } } </div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// A User-Agent from a desktop device.</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <a class="code" href="structevidence.html">evidence</a> desktopDevice = { </div><div class="c-code__line">    1, </div><div class="c-code__line">    { { <a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;user-agent&quot;</span>, (</div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Mozilla / 5.0 (Windows NT 10.0; Win64; x64) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;AppleWebKit/537.36 (KHTML, like Gecko) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Chrome/78.0.3904.108 Safari/537.36&quot;</span>) } } </div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Evidence values from a windows 11 device using a browser</span></div><div class="c-code__line"><span class="c-code__comment">// that supports User-Agent Client Hints.</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <a class="code" href="structevidence.html">evidence</a> userAgentClientHints = { </div><div class="c-code__line">    5,</div><div class="c-code__line">    { {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;user-agent&quot;</span>, (</div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;AppleWebKit/537.36 (KHTML, like Gecko) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Chrome/98.0.4758.102 Safari/537.36&quot;</span>)},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-mobile&quot;</span>, <span class="c-code__stringliteral">&quot;?0&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua&quot;</span>, (</div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;\&quot; Not A; Brand\&quot;;v=\&quot;99\&quot;, \&quot;Chromium\&quot;;v=\&quot;98\&quot;, &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;\&quot;Google Chrome\&quot;;v=\&quot;98\&quot;&quot;</span>)},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-platform&quot;</span>, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Windows&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;sec-ch-ua-platform-version&quot;</span>, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;\&quot;14.0.0\&quot;&quot;</span>} }</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">char</span> modileDeviceIDBuffer[50] = <span class="c-code__stringliteral">&quot;&quot;</span>; <span class="c-code__comment">// Evaluated at run time</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <a class="code" href="structevidence.html">evidence</a> userAgentWithMobileID = {</div><div class="c-code__line">    6,</div><div class="c-code__line">    { {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;user-agent&quot;</span>, (</div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;AppleWebKit/537.36 (KHTML, like Gecko) &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Chrome/98.0.4758.102 Safari/537.36&quot;</span>)},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-mobile&quot;</span>, <span class="c-code__stringliteral">&quot;?0&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua&quot;</span>, (</div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;\&quot; Not A; Brand\&quot;;v=\&quot;99\&quot;, \&quot;Chromium\&quot;;v=\&quot;98\&quot;, &quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;\&quot;Google Chrome\&quot;;v=\&quot;98\&quot;&quot;</span>)},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-platform&quot;</span>, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;Windows&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;sec-ch-ua-platform-version&quot;</span>, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;\&quot;14.0.0\&quot;&quot;</span>},</div><div class="c-code__line">    {<a name="a2"></a><a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a15b343154fc012939b162c1c0495fe1c">FIFTYONE_DEGREES_EVIDENCE_QUERY</a>, <span class="c-code__stringliteral">&quot;51D_deviceId&quot;</span>, modileDeviceIDBuffer} }</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <a class="code" href="structevidence.html">evidence</a> headersWithWebView = {</div><div class="c-code__line">    7,</div><div class="c-code__line">    { {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;user-agent&quot;</span>, </div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;Mozilla/5.0 (Linux; Android 13; RMX3762 Build/TP1A.220624.014; wv) &quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/122.0.6261.106 &quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;Mobile Safari/537.36 TwitterAndroid&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-mobile&quot;</span>, <span class="c-code__stringliteral">&quot;?1&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua&quot;</span>, </div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;\&quot;Chromium\&quot;;v=\&quot;122\&quot;, \&quot;Not(A:Brand\&quot;;v=\&quot;24\&quot;, &quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;\&quot;Android WebView\&quot;;v=\&quot;122\&quot;&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-platform&quot;</span>, </div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;\&quot;Android\&quot;&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-platform-version&quot;</span>, </div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;\&quot;13.0.0\&quot;&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-model&quot;</span>, </div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;\&quot;RMX3762\&quot;&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;sec-ch-ua-full-version&quot;</span>, </div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;\&quot;122.0.6261.106\&quot;&quot;</span>} }</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Base 64 string for the JSON returned from a call to getHighEntropyValues</span></div><div class="c-code__line"><span class="c-code__comment">// in JavaScript code. This key value pair would be generated by JavaScript</span></div><div class="c-code__line"><span class="c-code__comment">// returned from device detection, executed on the web page, and then the base </span></div><div class="c-code__line"><span class="c-code__comment">// 64 being returned to a second server request for device detection. Providing</span></div><div class="c-code__line"><span class="c-code__comment">// the value direct from user code would not be an expected use of the feature. </span></div><div class="c-code__line"><span class="c-code__comment">// The example is included to help those starting to work with the project </span></div><div class="c-code__line"><span class="c-code__comment">// understand that evidence is not always HTTP headers. A normal user-agent is</span></div><div class="c-code__line"><span class="c-code__comment">// included to show how this is ignored when better evidence is available.</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <a class="code" href="structevidence.html">evidence</a> getHighEntropyValues = {</div><div class="c-code__line">    2,</div><div class="c-code__line">    { {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a5bfdff3692f3fd3bb0506a7117e55402">FIFTYONE_DEGREES_EVIDENCE_HTTP_HEADER_STRING</a>, <span class="c-code__stringliteral">&quot;user-agent&quot;</span>, </div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, &quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;like Gecko) Chrome/98.0.4758.102 Safari/537.36&quot;</span>},</div><div class="c-code__line">    {<a class="code" href="group___fifty_one_degrees_common.html#gga1ff9010650f2716970e86c12c5a97a76a15b343154fc012939b162c1c0495fe1c">FIFTYONE_DEGREES_EVIDENCE_QUERY</a>, </div><div class="c-code__line">    <a name="a3"></a><a class="code" href="group___fifty_one_degrees_hash_api.html#gae3d208cef874d47cf0490c8b22a96d81">FIFTYONE_DEGREES_EVIDENCE_HIGH_ENTROPY_VALUES</a>,</div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;eyJicmFuZHMiOlt7ImJyYW5kIjoiTm90L0EpQnJhbmQiLCJ2ZXJzaW9uIjoiOCJ9LHsiYnJh&quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;bmQiOiJDaHJvbWl1bSIsInZlcnNpb24iOiIxMjYifSx7ImJyYW5kIjoiR29vZ2xlIENocm9t&quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;ZSIsInZlcnNpb24iOiIxMjYifV0sImZ1bGxWZXJzaW9uTGlzdCI6W3siYnJhbmQiOiJOb3Qv&quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;QSlCcmFuZCIsInZlcnNpb24iOiI4LjAuMC4wIn0seyJicmFuZCI6IkNocm9taXVtIiwidmVy&quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;c2lvbiI6IjEyNi4wLjY0NzguMTI3In0seyJicmFuZCI6Ikdvb2dsZSBDaHJvbWUiLCJ2ZXJz&quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;aW9uIjoiMTI2LjAuNjQ3OC4xMjcifV0sIm1vYmlsZSI6ZmFsc2UsIm1vZGVsIjoiIiwicGxh&quot;</span></div><div class="c-code__line">    <span class="c-code__stringliteral">&quot;dGZvcm0iOiJtYWNPUyIsInBsYXRmb3JtVmVyc2lvbiI6IjE0LjUuMCJ9&quot;</span>} }</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// This collection contains the various input values that will</span></div><div class="c-code__line"><span class="c-code__comment">// be passed to the device detection algorithm.</span></div><div class="c-code__line"><span class="c-code__keyword">static</span> <a class="code" href="structevidence.html">evidence</a>* evidenceValues[] = {</div><div class="c-code__line">    &amp;mobileDevice,</div><div class="c-code__line">    &amp;desktopDevice,</div><div class="c-code__line">    &amp;userAgentClientHints,</div><div class="c-code__line">    &amp;userAgentWithMobileID,</div><div class="c-code__line">    &amp;headersWithWebView,</div><div class="c-code__line">    &amp;getHighEntropyValues</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> outputValue(</div><div class="c-code__line">    <a name="_a4"></a><a class="code" href="structfiftyone_degrees_result_hash_array.html">ResultsHash</a> *results,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *name,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* propertyName,</div><div class="c-code__line">    FILE *output) {</div><div class="c-code__line">    <a name="_a5"></a><a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>* dataset = (<a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>*)results-&gt;<a name="a6"></a><a class="code" href="structfiftyone_degrees_result_hash_array.html#a0b613284cd3b79bbcb76cd694b77ac91">b</a>.<a name="a7"></a><a class="code" href="structfiftyone_degrees_results_device_detection.html#ab274eced26b8fd68a8170b27dac75dde">b</a>.<a name="a8"></a><a class="code" href="structfiftyone_degrees_results_base.html#acb1eb8a8fb245ea49299b19fd71fa1d5">dataSet</a>;</div><div class="c-code__line"></div><div class="c-code__line">    <a name="a9"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a>;</div><div class="c-code__line">    <span class="c-code__keywordtype">int</span> requiredPropertyIndex = <a name="a10"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga4b242308dfc68d6092df3607fbccd0cc">PropertiesGetRequiredPropertyIndexFromName</a>(</div><div class="c-code__line">        dataset-&gt;<a name="a11"></a><a class="code" href="structfiftyone_degrees_data_set_hash.html#a55d7db87af4c400bca7d04581a95b533">b</a>.<a name="a12"></a><a class="code" href="structfiftyone_degrees_data_set_device_detection.html#a69c6c6bb7cf4fea8d484e3dbe01053fb">b</a>.<a name="a13"></a><a class="code" href="structfiftyone_degrees_data_set_base.html#afb6fe7080fd386b7b4233ce5c87ce3c2">available</a>, </div><div class="c-code__line">        propertyName);</div><div class="c-code__line">    <span class="c-code__comment">// If a value has not been set then trying to access the value will</span></div><div class="c-code__line">    <span class="c-code__comment">// result in an exception.</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (<a name="a14"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gad3bee8167d56b6f7dbcff060c2564454">ResultsHashGetHasValues</a>(</div><div class="c-code__line">        results, requiredPropertyIndex, exception)) {</div><div class="c-code__line">        <a name="a15"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga1a4566495159559ee999f0b3780f63c9">ResultsHashGetValuesString</a>(</div><div class="c-code__line">            results,</div><div class="c-code__line">            propertyName,</div><div class="c-code__line">            valueBuffer,</div><div class="c-code__line">            valueBufferLength,</div><div class="c-code__line">            (<span class="c-code__keywordtype">char</span>* <span class="c-code__keyword">const</span>)<span class="c-code__stringliteral">&quot;,&quot;</span>,</div><div class="c-code__line">            exception);</div><div class="c-code__line">        <a name="a16"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a>;</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">        <span class="c-code__comment">// A no value message can also be obtained. This message describes why</span></div><div class="c-code__line">        <span class="c-code__comment">// the value has not been set.</span></div><div class="c-code__line">        <a class="code" href="group___fifty_one_degrees_results.html#gaef347b638495391733e5962b576321e6">fiftyoneDegreesResultsNoValueReason</a> reason =</div><div class="c-code__line">            <a name="a17"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga840206fdcd9bc13e7542cc9037fba112">ResultsHashGetNoValueReason</a>(</div><div class="c-code__line">                results, </div><div class="c-code__line">                requiredPropertyIndex, </div><div class="c-code__line">                exception);</div><div class="c-code__line">        <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a>;</div><div class="c-code__line"></div><div class="c-code__line">        snprintf(</div><div class="c-code__line">            valueBuffer, </div><div class="c-code__line">            valueBufferLength, </div><div class="c-code__line">            <span class="c-code__stringliteral">&quot;Unknown (%s)&quot;</span>, </div><div class="c-code__line">            <a name="a18"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gae634e1ec6a534a98af8603fec434282f">ResultsHashGetNoValueReasonMessage</a>(reason));</div><div class="c-code__line">    }</div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;\n\t%s: %s&quot;</span>, name, valueBuffer);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> reportStatus(<a class="code" href="group___fifty_one_degrees_status.html#ga887881c8b6ec9f0c8510913831ebd19e">StatusCode</a> status,</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span>* fileName) {</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *message = <a name="a19"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga3002890a18e3a86e4078880f2b00bbad">StatusGetMessage</a>(status, fileName);</div><div class="c-code__line">    printf(<span class="c-code__stringliteral">&quot;%s\n&quot;</span>, message);</div><div class="c-code__line">    <a name="a20"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gae0ecd1fc988dbb64ff0232a001e090bf">Free</a>((<span class="c-code__keywordtype">void</span>*)message);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">bool</span> reportHeader(</div><div class="c-code__line">    <span class="c-code__keywordtype">void</span>* state,</div><div class="c-code__line">    <a name="_a21"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html">EvidenceKeyValuePair</a>* pair) {</div><div class="c-code__line">    </div><div class="c-code__line">    <span class="c-code__comment">// Copy the key and value into null terminated strings for output.</span></div><div class="c-code__line">    <span class="c-code__keywordtype">char</span>* key = (<span class="c-code__keywordtype">char</span>*)<a name="a22"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gac35c76ff5632479d21272251b078a1d4">Malloc</a>(pair-&gt;<a name="a23"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a name="a24"></a><a class="code" href="structfiftyone_degrees_key_value_pair.html#a05d2d95e26d4da54515813aaf42c32a2">keyLength</a> + 1);</div><div class="c-code__line">    <span class="c-code__keywordtype">char</span>* value = (<span class="c-code__keywordtype">char</span>*)<a class="code" href="group___fifty_one_degrees_synonyms.html#gac35c76ff5632479d21272251b078a1d4">Malloc</a>(pair-&gt;<a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a name="a25"></a><a class="code" href="structfiftyone_degrees_key_value_pair.html#ab1625b8fdbd007a8bd8839fd1a8b6e3f">valueLength</a> + 1);</div><div class="c-code__line">    strncpy(key, pair-&gt;<a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a name="a26"></a><a class="code" href="structfiftyone_degrees_key_value_pair.html#a46640c5ce3f89ad32686f1b86562b757">key</a>, pair-&gt;<a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a class="code" href="structfiftyone_degrees_key_value_pair.html#a05d2d95e26d4da54515813aaf42c32a2">keyLength</a>);</div><div class="c-code__line">    strncpy(value, pair-&gt;<a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a name="a27"></a><a class="code" href="structfiftyone_degrees_key_value_pair.html#a51707019e68e09f713d963e02d1f4578">value</a>, pair-&gt;<a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a class="code" href="structfiftyone_degrees_key_value_pair.html#ab1625b8fdbd007a8bd8839fd1a8b6e3f">valueLength</a>);</div><div class="c-code__line">    key[pair-&gt;<a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a class="code" href="structfiftyone_degrees_key_value_pair.html#a05d2d95e26d4da54515813aaf42c32a2">keyLength</a>] = <span class="c-code__charliteral">&#39;\0&#39;</span>;</div><div class="c-code__line">    value[pair-&gt;<a class="code" href="structfiftyone_degrees_evidence_key_value_pair.html#a69fcd3978db523cc3b990e709c1172f5">item</a>.<a class="code" href="structfiftyone_degrees_key_value_pair.html#ab1625b8fdbd007a8bd8839fd1a8b6e3f">valueLength</a>] = <span class="c-code__charliteral">&#39;\0&#39;</span>;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Output the key and value.</span></div><div class="c-code__line">    fprintf((FILE*)state, <span class="c-code__stringliteral">&quot;\n\t%s: %s&quot;</span>, key, value);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Free memory.</span></div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#gae0ecd1fc988dbb64ff0232a001e090bf">Free</a>(key);</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#gae0ecd1fc988dbb64ff0232a001e090bf">Free</a>(value);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Keep iterating the evidence.</span></div><div class="c-code__line">    <span class="c-code__keywordflow">return</span> <span class="c-code__keyword">true</span>;</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> analyse(</div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_result_hash_array.html">ResultsHash</a>* results,</div><div class="c-code__line">    <a name="_a28"></a><a class="code" href="structfiftyone_degrees_evidence_key_value_pair_array.html">EvidenceKeyValuePairArray</a>* <a class="code" href="structevidence.html">evidence</a>,</div><div class="c-code__line">    FILE* output) {</div><div class="c-code__line">    <span class="c-code__comment">// Information required for detection is called &quot;evidence&quot;</span></div><div class="c-code__line">    <span class="c-code__comment">// and usually consists of a number of HTTP Header field</span></div><div class="c-code__line">    <span class="c-code__comment">// values, in this case represented by a</span></div><div class="c-code__line">    <span class="c-code__comment">// Object of header name/value entries.</span></div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// list the evidence</span></div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;Input values:&quot;</span>);</div><div class="c-code__line">    <a name="a29"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga0387d337d140012a456ff2c4e44f1162">EvidenceIterate</a>(<a class="code" href="structevidence.html">evidence</a>, INT_MAX, output, reportHeader);</div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;\n\n&quot;</span>);</div><div class="c-code__line"></div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a></div><div class="c-code__line">    <a name="a30"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga3695959f3706c2b267ad02133aab0f7b">ResultsHashFromEvidence</a>(results, <a class="code" href="structevidence.html">evidence</a>, exception);</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a></div><div class="c-code__line"></div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;Results:&quot;</span>);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;Mobile Device&quot;</span>, <span class="c-code__stringliteral">&quot;IsMobile&quot;</span>, output);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;Platform Name&quot;</span>, <span class="c-code__stringliteral">&quot;PlatformName&quot;</span>, output);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;Platform Version&quot;</span>, <span class="c-code__stringliteral">&quot;PlatformVersion&quot;</span>, output);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;Browser Name&quot;</span>, <span class="c-code__stringliteral">&quot;BrowserName&quot;</span>, output);</div><div class="c-code__line">    outputValue(results, <span class="c-code__stringliteral">&quot;Browser Version&quot;</span>, <span class="c-code__stringliteral">&quot;BrowserVersion&quot;</span>, output);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Shows the Device Id that can be used to look up the properties via</span></div><div class="c-code__line">    <span class="c-code__comment">// reference tables. </span></div><div class="c-code__line">    <span class="c-code__comment">// Note: Reference tables not shown and are available for on premise </span></div><div class="c-code__line">    <span class="c-code__comment">// subscribers using the CSV data format.</span></div><div class="c-code__line">    <a name="a31"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaef378eaba9b3f20b68efc4f30dc3cab7">HashGetDeviceIdFromResults</a>(</div><div class="c-code__line">        results,</div><div class="c-code__line">        valueBuffer,</div><div class="c-code__line">        <span class="c-code__keyword">sizeof</span>(valueBuffer),</div><div class="c-code__line">        exception);</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a>;</div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;\n\tDevice ID: %s\n&quot;</span>, valueBuffer);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Shows how to get all the required properties as a single JSON string.</span></div><div class="c-code__line">    <a name="a32"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaff5afc882e1fdd90cbe93414ed9297a8">ResultsHashGetValuesJson</a>(results,</div><div class="c-code__line">        valueBuffer,</div><div class="c-code__line">        <span class="c-code__keyword">sizeof</span>(valueBuffer),</div><div class="c-code__line">        exception);</div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;\n\tJSON: %s\n&quot;</span>, valueBuffer);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Shows the JavaScript that can be run in a User Agent Client Hint </span></div><div class="c-code__line">    <span class="c-code__comment">// compatible web browsers to return evidence needed for device detection</span></div><div class="c-code__line">    <span class="c-code__comment">// as a base64 string. See </span></div><div class="c-code__line">    <span class="c-code__comment">// https://51degrees.com/documentation/4.4/_device_detection__features__u_a_c_h__overview.html</span></div><div class="c-code__line">    outputValue(</div><div class="c-code__line">        results, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;GetHighEntropyValues JS&quot;</span>, </div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;JavascriptGetHighEntropyValues&quot;</span>, </div><div class="c-code__line">        output);</div><div class="c-code__line"></div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;\n\n&quot;</span>);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Iterate the evidence to show pseudo headers and GHEV results which is </span></div><div class="c-code__line">    <span class="c-code__comment">// only going to be exposed after the call to ResultsHashFromEvidence.</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (((<a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>*)results-&gt;<a class="code" href="structfiftyone_degrees_result_hash_array.html#a0b613284cd3b79bbcb76cd694b77ac91">b</a>.<a class="code" href="structfiftyone_degrees_results_device_detection.html#ab274eced26b8fd68a8170b27dac75dde">b</a>.<a class="code" href="structfiftyone_degrees_results_base.html#acb1eb8a8fb245ea49299b19fd71fa1d5">dataSet</a>)-&gt;b.ghevHeaders != NULL) {</div><div class="c-code__line">        fprintf(output, <span class="c-code__stringliteral">&quot;UACH evidence:&quot;</span>);</div><div class="c-code__line">            <a name="a33"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gafc4d4946bc16d0be416e56081fe1b883">EvidenceIterateForHeaders</a>(</div><div class="c-code__line">                <a class="code" href="structevidence.html">evidence</a>, </div><div class="c-code__line">                INT_MAX,</div><div class="c-code__line">                ((<a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>*)results-&gt;<a class="code" href="structfiftyone_degrees_result_hash_array.html#a0b613284cd3b79bbcb76cd694b77ac91">b</a>.<a class="code" href="structfiftyone_degrees_results_device_detection.html#ab274eced26b8fd68a8170b27dac75dde">b</a>.<a class="code" href="structfiftyone_degrees_results_base.html#acb1eb8a8fb245ea49299b19fd71fa1d5">dataSet</a>)-&gt;b.ghevHeaders,</div><div class="c-code__line">                NULL, </div><div class="c-code__line">                0, </div><div class="c-code__line">                output, </div><div class="c-code__line">                reportHeader);</div><div class="c-code__line">            fprintf(output, <span class="c-code__stringliteral">&quot;\n\n&quot;</span>);</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;---###---&quot;</span>);</div><div class="c-code__line">    fprintf(output, <span class="c-code__stringliteral">&quot;\n\n&quot;</span>);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keywordtype">void</span> fiftyoneDegreesHashGettingStarted(</div><div class="c-code__line">    <span class="c-code__keyword">const</span> <span class="c-code__keywordtype">char</span> *dataFilePath,</div><div class="c-code__line">    <a name="_a34"></a><a class="code" href="structfiftyone_degrees_config_hash.html">ConfigHash</a> *config,</div><div class="c-code__line">    FILE* output) {</div><div class="c-code__line">    <a name="_a35"></a><a class="code" href="structfiftyone_degrees_resource_manager.html">ResourceManager</a> manager;</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga29a7b1eb8b59c26629548b1de83b473b">EXCEPTION_CREATE</a>;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Set the properties to be returned for each User-Agent. Specifying the</span></div><div class="c-code__line">    <span class="c-code__comment">// properties that will later be retrieved or used during device detection </span></div><div class="c-code__line">    <span class="c-code__comment">// at initialisation time improves performance.</span></div><div class="c-code__line">    <span class="c-code__comment">// Note: The Accept-CH properties are used to prevent the </span></div><div class="c-code__line">    <span class="c-code__comment">// JavascriptGetHighEntropyValues value being returned when all the data is</span></div><div class="c-code__line">    <span class="c-code__comment">// already present in the evidence.</span></div><div class="c-code__line">    <a name="_a36"></a><a class="code" href="structfiftyone_degrees_properties_required.html">PropertiesRequired</a> properties = { </div><div class="c-code__line">        NULL,</div><div class="c-code__line">        0,</div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;IsMobile,PlatformName,PlatformVersion,BrowserName,BrowserVersion,&quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;HardwareImages,SetHeaderBrowserAccept-CH,SetHeaderHardwareAccept-CH,&quot;</span></div><div class="c-code__line">        <span class="c-code__stringliteral">&quot;SetHeaderPlatformAccept-CH,JavascriptGetHighEntropyValues&quot;</span>,</div><div class="c-code__line">        NULL };</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Initialise the manager for device detection.</span></div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_status.html#ga887881c8b6ec9f0c8510913831ebd19e">StatusCode</a> status = <a name="a37"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaf32e91a9120e015fb219a3044498f7bc">HashInitManagerFromFile</a>(</div><div class="c-code__line">        &amp;manager,</div><div class="c-code__line">        config,</div><div class="c-code__line">        &amp;properties,</div><div class="c-code__line">        dataFilePath,</div><div class="c-code__line">        exception);</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a>;</div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (status != <a name="a38"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {</div><div class="c-code__line">        reportStatus(status, dataFilePath);</div><div class="c-code__line">        fgetc(stdin);</div><div class="c-code__line">        <span class="c-code__keywordflow">return</span>;</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Create a results instance to store and process evidence.</span></div><div class="c-code__line">    <span class="c-code__comment">// The capacity of the results should be the same as the maximum potential</span></div><div class="c-code__line">    <span class="c-code__comment">// evidence that can be provided. </span></div><div class="c-code__line">    <span class="c-code__comment">// Note: Capacity of overriding values dynamically is required to ensure </span></div><div class="c-code__line">    <span class="c-code__comment">// that the JavascriptGetHighEntropyValues code can be blocked from being</span></div><div class="c-code__line">    <span class="c-code__comment">// returned when all the required evidence is already present.</span></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_result_hash_array.html">ResultsHash</a> *results = <a name="a39"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga6eee92bf88015e1e2caba34a2f4589d6">ResultsHashCreate</a>(&amp;manager, 1);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keywordflow">for</span> (<span class="c-code__keywordtype">int</span> i = 0;</div><div class="c-code__line">        i &lt; (int)<span class="c-code__keyword">sizeof</span>(evidenceValues)/(int)<span class="c-code__keyword">sizeof</span>(<a class="code" href="structevidence.html">evidence</a>*);</div><div class="c-code__line">        i++) {</div><div class="c-code__line">        <span class="c-code__comment">// Create an evidence collection and add the evidence.</span></div><div class="c-code__line">        <a class="code" href="structevidence.html">evidence</a>* evs = evidenceValues[i];</div><div class="c-code__line">        <a class="code" href="structfiftyone_degrees_evidence_key_value_pair_array.html">EvidenceKeyValuePairArray</a>* evidenceArray = <a name="a40"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga324c123e74727b62612edeead5d0f6a6">EvidenceCreate</a>(evs-&gt;<a name="a41"></a>count);</div><div class="c-code__line">        <span class="c-code__keywordflow">for</span> (uint32_t j = 0; j &lt; evs-&gt;count; j++) {</div><div class="c-code__line">            <a name="a42"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga9154c7bee1590af184d75fbe74a1c4dd">EvidenceAddString</a>(</div><div class="c-code__line">                evidenceArray,</div><div class="c-code__line">                evs-&gt;<a name="a43"></a>items[j].<a name="a44"></a>prefix,</div><div class="c-code__line">                evs-&gt;items[j].<a name="a45"></a>key,</div><div class="c-code__line">                evs-&gt;items[j].<a name="a46"></a>value);</div><div class="c-code__line">        }</div><div class="c-code__line">        analyse(results, evidenceArray, output);</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> (i == 0) {</div><div class="c-code__line">            <span class="c-code__comment">// save mobile device ID to be used in later evidence</span></div><div class="c-code__line">            <a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaef378eaba9b3f20b68efc4f30dc3cab7">HashGetDeviceIdFromResults</a>(</div><div class="c-code__line">                results,</div><div class="c-code__line">                modileDeviceIDBuffer,</div><div class="c-code__line">                <span class="c-code__keyword">sizeof</span>(modileDeviceIDBuffer),</div><div class="c-code__line">                exception);</div><div class="c-code__line">            <a class="code" href="group___fifty_one_degrees_synonyms.html#ga1d1a54ffb69cad881269379cc5af3f35">EXCEPTION_THROW</a>;</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__comment">// Ensure the evidence collection is freed after used</span></div><div class="c-code__line">        <a name="a47"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gac0d0435d95ea76ed3ee71c0348b3be81">EvidenceFree</a>(evidenceArray);</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Check data file</span></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a>* dataset = (<a class="code" href="structfiftyone_degrees_data_set_hash.html">DataSetHash</a> *)results-&gt;<a class="code" href="structfiftyone_degrees_result_hash_array.html#a0b613284cd3b79bbcb76cd694b77ac91">b</a>.<a class="code" href="structfiftyone_degrees_results_device_detection.html#ab274eced26b8fd68a8170b27dac75dde">b</a>.<a class="code" href="structfiftyone_degrees_results_base.html#acb1eb8a8fb245ea49299b19fd71fa1d5">dataSet</a>;</div><div class="c-code__line">    fiftyoneDegreesExampleCheckDataFile(dataset);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Ensure the results are freed to avoid memory leaks.</span></div><div class="c-code__line">    <a name="a48"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaef12979129e46a5fd7ebb6be8867a88d">ResultsHashFree</a>(results);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Free the resources used by the manager.</span></div><div class="c-code__line">    <a name="a49"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gac5094875841e9d95dc972014124ea765">ResourceManagerFree</a>(&amp;manager);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keywordtype">void</span> fiftyoneDegreesExampleCGettingStartedRun(ExampleParameters *params) {</div><div class="c-code__line">    <span class="c-code__comment">// Call the actual function.</span></div><div class="c-code__line">    fiftyoneDegreesHashGettingStarted(</div><div class="c-code__line">        params-&gt;dataFilePath,</div><div class="c-code__line">        params-&gt;config,</div><div class="c-code__line">        params-&gt;output);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">#ifndef TEST</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keywordtype">int</span> main(<span class="c-code__keywordtype">int</span> argc, <span class="c-code__keywordtype">char</span>* argv[]) {</div><div class="c-code__line">    <a class="code" href="group___fifty_one_degrees_status.html#ga887881c8b6ec9f0c8510913831ebd19e">StatusCode</a> status = <a class="code" href="group___fifty_one_degrees_synonyms.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;</div><div class="c-code__line">    <span class="c-code__comment">// We use the low memory profile as its performance is sufficient for this </span></div><div class="c-code__line">    <span class="c-code__comment">// example. See the documentation for more detail on this and other </span></div><div class="c-code__line">    <span class="c-code__comment">// configuration options:</span></div><div class="c-code__line">    <span class="c-code__comment">// http://51degrees.com/documentation/_device_detection__features__performance_options.html</span></div><div class="c-code__line">    <span class="c-code__comment">// http://51degrees.com/documentation/_features__automatic_datafile_updates.html</span></div><div class="c-code__line">    <span class="c-code__comment">// http://51degrees.com/documentation/_features__usage_sharing.html</span></div><div class="c-code__line">    <a class="code" href="structfiftyone_degrees_config_hash.html">ConfigHash</a> config = <a name="a50"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#gaef431ba768d121b39837cef7e1a51158">HashLowMemoryConfig</a>;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Path for the data file.</span></div><div class="c-code__line">    <span class="c-code__keywordtype">char</span> dataFilePath[<a name="a51"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#gafd3ee670ff4ed3f29a395abd2f0f3344">FILE_MAX_PATH</a>];</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Use the supplied path for the data file or find the lite data that</span></div><div class="c-code__line">    <span class="c-code__comment">// is included in the repository</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (argc &gt; 1) {</div><div class="c-code__line">        strcpy(dataFilePath, argv[1]);</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">        status = <a name="a52"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga5ba06bcfd18437e9145833037dd7ecc9">FileGetPath</a>(</div><div class="c-code__line">            dataDir,</div><div class="c-code__line">            dataFileName,</div><div class="c-code__line">            dataFilePath,</div><div class="c-code__line">            <span class="c-code__keyword">sizeof</span>(dataFilePath));</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (status != <a class="code" href="group___fifty_one_degrees_synonyms.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {</div><div class="c-code__line">        printf((<span class="c-code__stringliteral">&quot;Failed to find a device detection &quot;</span></div><div class="c-code__line">            <span class="c-code__stringliteral">&quot;data file. Make sure the device-detection-data &quot;</span></div><div class="c-code__line">            <span class="c-code__stringliteral">&quot;submodule has been updated by running &quot;</span></div><div class="c-code__line">            <span class="c-code__stringliteral">&quot;`git submodule update --recursive`&quot;</span>));</div><div class="c-code__line">        fgetc(stdin);</div><div class="c-code__line">        <span class="c-code__keywordflow">return</span> 1;</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Check if the example is compiled for memory usage only in which case</span></div><div class="c-code__line">    <span class="c-code__comment">// the in memory configuration must be used.</span></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (<a name="a53"></a><a class="code" href="group___fifty_one_degrees_synonyms.html#ga1e09607f004644224a45bc6057393de6">CollectionGetIsMemoryOnly</a>()) {</div><div class="c-code__line">        config = <a name="a54"></a><a class="code" href="group___fifty_one_degrees_hash_synonyms.html#ga90e4ca7b9a7843dcfd2ab2a2340ca694">HashInMemoryConfig</a>;</div><div class="c-code__line">    }</div><div class="c-code__line">    </div><div class="c-code__line">    <span class="c-code__comment">// The example shows how non HTTP header evidence can be provided. Set</span></div><div class="c-code__line">    <span class="c-code__comment">// special evidence processing to true to ensure this example returns </span></div><div class="c-code__line">    <span class="c-code__comment">// results.</span></div><div class="c-code__line">    config.<a name="a55"></a><a class="code" href="structfiftyone_degrees_config_hash.html#a7df616c1c12c853ce8042fa41a184f3f">b</a>.<a name="a56"></a><a class="code" href="structfiftyone_degrees_config_device_detection.html#a4f9955e955f2449663aea927c5a46ccb">processSpecialEvidence</a> = <span class="c-code__keyword">true</span>;</div><div class="c-code__line"></div><div class="c-code__line">    ExampleParameters params;</div><div class="c-code__line">    params.dataFilePath = dataFilePath;</div><div class="c-code__line">    params.config = &amp;config;</div><div class="c-code__line">    params.output = stdout;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Run the example</span></div><div class="c-code__line">    fiftyoneDegreesExampleMemCheck(</div><div class="c-code__line">        &amp;params,</div><div class="c-code__line">        fiftyoneDegreesExampleCGettingStartedRun);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Wait for a character to be pressed.</span></div><div class="c-code__line">    fgetc(stdin);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keywordflow">return</span> 0;</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">#endif</span></div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
